# 任务计划

## 一次性安排进程

at 安排作业再某一时刻执行一次

batch 安排作业在系统负载不重时执行一次

使用at步骤

1. 安装at并开启atd服务
    - yum install at -y
    - service atd start
2. 编辑任务
    - at timepoint
    - 在timepoint执行某个程序，必须使用绝对路径
        1. 绝对计时方法
            - midnight noon teatime
            - HH:MMpm
            - HH:MM[today]，HH:MM tomorrow
            - HH:MM 星期
            - HH:MM mm/dd/yyyy 
            - HH:MM dd.mm.yyyy
        2. 相对计时方法
            - now + n minutes
            - now + n hours
            - now + n day
    - ctrl+d 退出编辑
    - at -f filename timepoint 使用编辑好命令的文件
    - at < filename timepoint 使用命令文件重定向到at
3. 查看任务
    - at -l 或者atq查看有哪些任务
4. 删除任务
    - at -d 标识符 （atrm 标识符）
5. at的执行结果
    - at的执行结果会通过邮件提交给用户
6. at的配置文件
    - 限制哪些用户可以使用at命令
    - /etc/at.allow, 这个文件存在，只有列在此文件中的用户可以使用at命令，如果不存在，则查/etc/at.deny
    - /etc/at.deny，如果这个文件存在，则在此文件中列出的用户都不能使用at命令
    - 如果两个文件都不存在，则只有root用户可以使用at，如果都存在而且均为空，则所有用户都可以使用at命令。

## 周期性安排进程任务

crond

1. 开启服务
    - service crond start
    - crond 进程搜索crontab文件并载入内存
    - crontab文件即/var/spool/cron/目录下以用户名命名的文件
    - crond 进程启动以后，将首先检查用户是否设置了crontab文件，如果有则每分钟检查crontab文件是否有需要执行的命令，命令执行结束后，任何输出都将作为邮件发送给crontab的所有者；如果没有转入“休眠”状态，释放系统资源。
2. 编辑cron文件
    - crontab -e
    - -u username 默认时当前用户
    - crontab由6个字段组成
        - minute：一个小时中哪一分钟[0~59]
        - hour：一天中哪个小时[0~23]
        - day-of-month：一个月中那一天[1~31]
        - month-of-year：一年中的哪一月[1~12]
        - day-of-week：一周中的哪一天[0~6]
        - commands：执行的命令，必须全路径
        - 这些项不能为空，必须填入；如果不需要，则使用通配符\*表示任何时间；如果指定多个值，可以逗号隔开，或者用-来表示区间，用*/n表示每隔n个单位执行命令。
3. 查看任务
    - crontab -l 在标准输出中显示crontab
4. 删除任务
    - crontab -r 删除当前用户的的crontab

5. 配置文件
    - 限制哪些用户使用crontab命令
    - /etc/cron.allow
    - /etc/con.deny