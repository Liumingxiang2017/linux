# 文件管理

ls -R 递归显示所有目录和文件
ls -d 不递归
mkdir -P  递归创建目录
rm -rf 递归删除目录


## 文件查找

### whereis

where find 显示find程序和程序帮助手册位置

where -b find 只显示find二进制文件位置

### which

which ls 显示ls路劲，如果有alias也会显示

### locate

非实时，模糊匹配，查找是根据全系统文件数据库进行的；

updatedb, 手动生成文件数据库

优点：速度快

### find

	实时
	精确
	支持众多查找标准
	遍历指定目录中的所有文件完成查找，速度慢；
	
find 查找路径 查找标准 查找到以后的处理运作

find DIRECTORY CRETIRIA ACTION

查找路径：默认为当前目录
查找标准：默认为指定路径下的所有文件
处理运作：默认为显示

匹配标准：

-name 'FILENAME'：对文件名作精确匹配
	文件名通配：
		*：任意长度的任意字符
		?
		[]
-iname 'FILENAME': 文件名匹配时不区分大小写
-regex PATTERN：基于正则表达式进行文件名匹配

-user USERNAME: 根据属主查找
-group GROUPNAME: 根据属组查找

-uid UID: 根据UID查找
-gid GID: 根据GID查找

-nouser：查找没有属主的文件
-nogroup: 查找没有属组的文件

-type

- f: 普通文件
- d: 目录
- c
- b: 块文件
- l: 链接
- p: 管道
- s: 套接字

-size [+|-]

	#k
	#M
	#G

组合条件：
	-a
	-o
	-not
    \(\)

/tmp目录，不是目录，并且还不能套接字类型的文件
/tmp/test目录下，属主不是user1，也不是user2的文件；

	-mtime 内容修改时间
	-ctime 属性修改时间
	-atime 访问时间
		[+|-]#
	-mmin
	-cmin
	-amin
		[+|-]#
		
	-perm MODE：精确匹配
		/MODE: 任意一位匹配即满足条件
		-MODE: 文件权限能完全包含此MODE时才符合条件
		
		-644
		644: rw-r--r--
		755: rwxr-xr-x
		750: rwxr-x---
	find ./ -perl -001

运作：

- -print: 显示
- -ls：类似ls -l的形式显示每一个文件的详细
- -ok COMMAND {} \; 每一次操作都需要用户确认
- -exec COMMAND {} \; 
	find不可以用管道符，使用-exec代替，{}代表find命令得出的结果，\;表示结束符
	find / -name FileName -exec cp -rf {} /root \;

1、查找/var目录下属主为root并且属组为mail的所有文件；

```shell
find /var -user root -group mail
```

2、查找/usr目录下不属于root,bin,或student的文件；
find /usr -not -user root -a -not -user bin -a -not -user student
find /usr -not \( -user root -o -user bin -o -user student \)

3、查找/etc目录下最近一周内内容修改过且不属于root及student用户的文件；
find /etc -mtime -7 -not \ ( -user root -o -user student \)
find /etc -mtime -7 -not -user root -a -not -user student


4、查找当前系统上没有属主或属组且最近1天内曾被访问过的文件，并将其属主属组均修改为root；
find / \( -nouser -o -nogroup \) -a -atime -1 -exec chown root:root {} \; 

5、查找/etc目录下大于1M的文件，并将其文件名写入/tmp/etc.largefiles文件中；
find /etc -size +1M >> /tmp/etc.largefiles

6、查找/etc目录下所有用户都没有写权限的文件，显示出其详细信息；
find /etc -not -perm /222 -ls	


练习：写一个脚本
写一个脚本，显示当前系统上shell为-s指定类型的用户，并统计其用户总数。-s选项后面跟的参数必须是/etc/shells文件中存在的shell类型，否则不执行此脚本。另外，此脚本还可以接受--help选项，以显示帮助信息。脚本执行形如：
./showshells.sh -s bash
显示结果形如：
BASH，3users，they are:
root,redhat,gentoo


#!/bin/bash
#
if [ $1 == '-s' ]; then
  ! grep "${2}$" /etc/shells &> /dev/null && echo "Invalid shell." && exit 7
elif [ $1 == '--help' ];then
  echo "Usage: showshells.sh -s SHELL | --help"
  exit 0
else
  echo "Unknown Options."
  exit 8
fi

NUMOFUSER=`grep "${2}$" /etc/passwd | wc -l`
SHELLUSERS=`grep "${2}$" /etc/passwd | cut -d: -f1`
SHELLUSERS=`echo $SHELLUSERS | sed 's@[[:space:]]@,@g'`

echo -e "$2, $NUMOFUSER users, they are: \n$SHELLUSERS"

${变量名}


## 压缩、解压缩命令

压缩格式：gz, bz2, xz, zip, Z

压缩算法：算法不同，压缩比也会不同；

compress: FILENAME.Z
uncompress

gzip: .gz
	gzip /PATH/TO/SOMEFILE：压缩完成后会删除原文件
		-d： 
		-#：1-9，指定压缩比，默认是6；
	
gunzip: 
	gunzip /PATH/TO/SOMEFILE.gz: 解压完成后会删除原文件
zcat /PATH/TO/SOMEFILE.gz： 不解压的情况，查看文本文件的内容
	

bzip2: .bz2
比gzip有着更大压缩比的压缩工具，使用格式近似
	bzip2 /PATH/TO/SOMEFILE
		-d
		-#: 1-9,默认是6
		-k: 压缩时保留原文件
		
	bunzip2 /PATH/TO/SOMEFILE.bz2
	bzcat

xz: .xz
	xz /PATH/TO/SOMEFILE
		-d
		-#: 1-9, 默认是6
		-k: 压缩时保留原文件
		
	unxz
	xzdec
	xzcat 

zip: 既归档又压缩的工具
	zip FILENAME.zip FILE1 FILE2 ...: 压缩后不删除原文件
	unzip FILENAME.zip
	
archive: 归档，归档本身并不意味着压缩

xz, bz2, gz


tar: 归档工具, .tar
	-c: 创建归档文件
	-f FILE.tar: 操作的归档文件
	-x: 展开归档
	--xattrs: 归档时，保留文件的扩展属性信息
	-t: 不展开归档，直接查看归档了哪些文件

	-zcf: 归档并调用gzip压缩
	-zxf: 调用gzip解压缩并展开归档，-z选项可省略
	
	-jcf: bzip2
	-jxf:
	
	-Jcf: xz
	-Jxf:

cpio: 归档工具
	

	
练习：写一个脚本
从键盘让用户输入几个文件，脚本能够将此几个文件归档压缩成一个文件；
read:
	-p “PROMPT": 给出提示

ln [-s -v] SRC DEST


硬链接：
	1、只能对文件创建，不能应用于目录；
	2、不能跨文件系统；
	3、创建硬链接会增加文件被链接的次数；
	
符号链接：
	1、可应用于目录；
	2、可以跨文件系统；
	3、不会增加被链接文件的链接次数；
	4、其大小为指定的路径所包含的字符个数；

